# 波浪線動畫 (Graphic Line Wave)

Version 1.2.0

一個使用 HTML Canvas 實現的簡單優雅的波浪線動畫。波浪線會隨機生成，並自然地從右向左流動，呈現出平滑、連續的波動效果。

## 功能特點

- 全屏顯示的波浪線動畫
- 波浪線會自然、平滑地從右向左流動
- 每次載入頁面時，波浪線都會以隨機的振幅、頻率和位置生成
- 無抖動的平滑動畫效果
- 波浪線延伸到畫面外，視覺上更加連續
- 輕量級實現，僅使用原生 JavaScript，無需第三方庫
- 極細的線條寬度（0.5px）呈現更精緻的視覺效果
- 自然的垂直飄浮效果
- 優化的波浪曲率，提供更柔和的視覺體驗

## 程式檔案說明

### index.html
主要的 HTML 檔案，提供基本的網頁結構。

關鍵功能：
- 設置網頁視窗基本屬性
  - viewport 設置確保移動設備正確顯示
  - meta 標籤設置字符編碼和相容性
- 引入必要的 JavaScript 檔案
  - 使用 defer 屬性確保 DOM 載入完成後執行
  - 模組化載入保持代碼整潔
- 設置畫布容器樣式
  - 全屏顯示設置
  - 溢出處理
  - z-index 層級管理
- 優化移動設備顯示
  - 觸控事件處理
  - 響應式設計支援
  - 設備像素比適配

```html
主要結構：
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>波浪線動畫</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <canvas id="waveCanvas"></canvas>
    <script src="main.js" defer></script>
</body>
</html>
```

### main.js
核心動畫邏輯實現檔案，包含完整的波浪動畫系統。

關鍵功能和參數：
1. **初始化設置**
   - Canvas 創建和配置
     - 獲取 2D 繪圖上下文
     - 設置畫布尺寸
     - 配置繪圖參數
   - 自適應視窗大小
     - 監聽視窗大小變化
     - 動態調整畫布尺寸
     - 保持畫面比例
   - 動態調整畫布尺寸
     - 處理設備像素比
     - 優化高 DPI 顯示
     - 確保清晰度

2. **波形參數系統**
   - `baseAmplitude`：基礎波形振幅（97.5-136.5）
     - 控制波浪的基本高度
     - 隨機範圍確保變化性
     - 經過優化的合適範圍
   - `frequency`：波形頻率（0.0013-0.00325）
     - 決定波浪的密度
     - 影響曲線的平滑程度
     - 優化後的自然頻率
   - `phase`：波形相位（隨機）
     - 確保每次載入的獨特性
     - 影響波形起始位置
     - 範圍：0 到 2π
   - `speed`：波形移動速度
     - 控制波形變化速率
     - 影響動畫流暢度
     - 可調範圍：0.01-0.03
   - `horizontalSpeed`：水平移動速度
     - 控制整體移動速度
     - 範圍：1-1.5 像素/幀
     - 平滑的位移效果
   - `floatSpeed`：垂直飄浮速度
     - 控制上下飄動速率
     - 範圍：0.0008-0.0012
     - 創造輕盈感
   - `floatAmplitude`：垂直飄浮幅度
     - 控制飄動的高度
     - 範圍：30-50 像素
     - 自然的起伏效果

3. **子波系統**
   - 主波形疊加兩個子波
     - 子波 1：低頻率補充
     - 子波 2：高頻率細節
     - 動態相位差異
   - 每個子波具有獨立的頻率、振幅和相位
     - 頻率比例關係優化
     - 振幅比例科學設計
     - 隨機相位確保變化
   - 用於創造更自然的波動效果
     - 避免機械感
     - 增加隨機性
     - 豐富視覺層次

4. **動畫優化技術**
   - requestAnimationFrame 實現流暢動畫
     - 同步瀏覽器刷新率
     - 優化性能消耗
     - 避免掉幀現象
   - 幀間平滑過渡機制
     - 85% 舊幀保留
     - 15% 新幀融合
     - 消除抖動
   - 抗鋸齒處理
     - 線條平滑化
     - 高 DPI 適配
     - 視覺優化
   - 畫面外延伸處理
     - 無縫連接處理
     - 避免邊緣斷裂
     - 增加延續性

5. **事件處理**
   - 視窗大小變化響應
     - 即時調整尺寸
     - 保持比例關係
     - 重置必要參數
   - 觸控設備優化
     - 觸摸事件支援
     - 性能優化處理
     - 手勢識別準備
   - 性能監控和優化
     - FPS 監控
     - 記憶體使用追蹤
     - 自動調整機制

### style.css
樣式表檔案，處理視覺呈現和響應式設計。

關鍵樣式設置：
1. **基礎樣式**
```css
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html, body {
    width: 100%;
    height: 100%;
    overflow: hidden;
}
```

2. **Canvas 容器樣式**
```css
#waveCanvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
}
```

3. **響應式設計**
- 媒體查詢適配
  - 不同設備尺寸
  - 方向變化處理
  - 像素密度適配
- 觸控優化
  - 禁用不必要的觸摸行為
  - 優化交互體驗
  - 防止意外縮放
- 效能考量
  - 最小化重繪區域
  - 啟用硬件加速
  - 優化動畫性能

4. **兼容性處理**
- 跨瀏覽器支援
  - 主流瀏覽器前綴
  - 降級方案處理
  - 功能檢測
- 移動設備支援
  - 觸控事件優化
  - 視口適配
  - 方向變化處理

## 參數調整指南

### 波形參數調整
1. **振幅（Amplitude）**
   - `baseAmplitude`：控制波浪高度
   - 建議範圍：50-200
   - 當前設置：97.5-136.5

2. **頻率（Frequency）**
   - `frequency`：控制波浪密度
   - 建議範圍：0.001-0.005
   - 當前設置：0.0013-0.00325

3. **速度參數**
   - `speed`：波形變化速度
   - `horizontalSpeed`：水平移動速度
   - `floatSpeed`：垂直飄浮速度

### 視覺效果微調
1. **線條設置**
   - `lineWidth`：線條寬度（當前 0.5px）
   - `strokeStyle`：線條顏色和透明度

2. **動畫平滑度**
   - 幀間過渡比例：85% 舊幀 + 15% 新幀
   - 可通過調整比例改變平滑程度

## 技術實現

- **HTML5 Canvas**: 使用 Canvas 2D Context 進行繪圖
- **數學模型**: 
  - 使用多個不同頻率、振幅和相位的正弦波疊加，創造自然隨機的波形
  - 優化的曲率控制系統，實現更自然的波浪形態
  - 獨立的垂直飄浮參數，創造輕盈感
- **動畫優化**: 
  - 使用 requestAnimationFrame 實現高效流暢的動畫
  - 幀間平滑過渡 (85% 前一幀 + 15% 當前幀)，減少抖動
  - 使用水平偏移量實現從右至左的流動效果
  - 精細的線條寬度控制（0.5px）

## 效能優化建議

1. **記憶體管理**
   - 避免在動畫循環中創建新對象
   - 重用已有的數組和變數
   - 適時清理不需要的資源

2. **渲染優化**
   - 使用 requestAnimationFrame 代替 setInterval
   - 最小化每幀的計算量
   - 使用適當的畫布大小

3. **移動設備優化**
   - 根據設備性能調整參數
   - 降低移動設備的渲染精度
   - 優化觸控事件處理

## 更新日誌

### Version 1.2.0 (2024-04-20)
- 優化波浪線的曲率控制
- 調整波浪線的彎曲程度，使其更加自然
- 添加垂直方向的飄浮效果，增強視覺動感
- 完善波形參數的隨機生成範圍

### Version 1.1.0 (2024-04-20)
- 將線條寬度從 2.5px 減少到 0.5px，實現更精緻的視覺效果
- 優化了波浪線的顯示效果，使其更加細緻優雅

### Version 1.0.0
- 初始版本發布

## 如何使用

1. 克隆此倉庫:
```
git clone https://github.com/chenweichiang/Graphic-Line-Wave.git
```

2. 在瀏覽器中打開 `index.html` 文件

無需安裝其他依賴，打開即可使用。

## 開發過程中使用的 Prompt

以下是開發這個動畫過程中使用的主要提示詞（按時間順序）：

1. "把index改成只顯示全畫面的main.js" - 簡化頁面，只顯示動畫
2. "我想要讓main中的波浪是同一條線自然的隨機波動像波浪一樣" - 優化波浪的自然感
3. "線上面不要再有額外的波浪形狀" - 移除小波浪，保持單一平滑曲線
4. "讓線波動非常滑順" - 改進動畫平滑度
5. "把線上的小波浪刪掉" - 再次優化波浪形狀
6. "為什麼現在的線不是隨機的" - 添加更好的隨機性
7. "現在的線波形不夠大要再大50%" - 調整波浪大小
8. "又開始在抖動了把抖動拿掉" - 修復抖動問題
9. "這條線產生之後就會開始由右至左自然波動" - 添加從右至左的移動效果
10. "把main.js裡面的線改成0.5px" - 優化線條寬度（Version 1.1.0）
11. "我想要讓main當中的線動動態加上飄浮的感覺" - 添加垂直飄浮效果
12. "讓線彎曲的曲率減少50%" - 調整波浪曲率
13. "增加30%" - 微調波浪曲率至最佳效果

### Prompt 參數調整說明

1. **線條寬度調整**
   - 原始寬度：2.5px
   - 最終寬度：0.5px
   - 目的：實現更精緻的視覺效果

2. **波浪曲率調整過程**
   - 初始曲率：100%
   - 減少50%：調整至較平緩的效果
   - 增加30%：找到最佳平衡點
   - 最終參數：
     - baseAmplitude：97.5-136.5
     - frequency：0.0013-0.00325

3. **飄浮效果參數**
   - floatSpeed：0.0008-0.0012
   - floatAmplitude：30-50 像素
   - 效果：實現自然的上下飄動

### Prompt 使用技巧

1. **參數調整建議**
   - 使用百分比進行相對調整
   - 先做大幅度調整，再進行微調
   - 保持參數之間的比例關係

2. **效果優化流程**
   - 先調整主要視覺效果
   - 再加入次要動態效果
   - 最後進行精細化調整

3. **問題解決方式**
   - 明確描述問題現象
   - 一次只調整一個參數
   - 及時驗證調整效果

## 可能的改進方向

- 添加顏色變化效果
- 允許用戶通過 UI 控制波浪的參數（速度、大小等）
- 添加多條不同顏色和速度的波浪線
- 在移動設備上優化性能
- 添加聲音效果，與波浪運動同步

## 授權

MIT 授權。

## 貢獻

歡迎提交問題和改進建議。

## 問題排解指南

### 常見問題
1. **畫面抖動**
   - 檢查幀間過渡比例設置
   - 確認 requestAnimationFrame 使用正確
   - 檢查裝置效能是否足夠

2. **效能問題**
   - 降低波形計算精度
   - 減少子波數量
   - 調整畫布大小

3. **顯示異常**
   - 確認視窗大小事件處理
   - 檢查 Canvas 上下文設置
   - 驗證樣式表正確載入